{% extends "common/base.html" %}
{% load crispy_forms_tags %}
{% load static %}

{% block title %}
Request New Allocation
{% endblock %}

{% block content %}
<style>
	label:not(.form-check-label) {
	  font-weight: bold;
	}
  	.horizontal-radio li {
       display: inline-block;
       margin-right: 10px;
   }
</style>

<h2>Request New {{ resource_obj.name }} Allocation <br><small>Project: {{ project_obj.title }}</small></h2>
<hr>

<form method="post">
	{% csrf_token %}
	{{ form|as_crispy_errors }}
	<fieldset>
		<legend><u>Contact Information</u></legend>
		<div class="row">
			<div class="col">
				{{ form.first_name|as_crispy_field }}
			</div>
			<div class="col">
				{{ form.last_name|as_crispy_field }}
			</div>
		</div>
		<div class="row">
			<div class="col">
				{{ form.campus_affiliation|as_crispy_field }}
			</div>
			<div class="col">
				{{ form.email|as_crispy_field }}
			</div>
		</div>
	</fieldset>
	<fieldset>
		<legend><u>Project Information</u></legend>
		{{ form.url|as_crispy_field }}
		{{ form.project_directory_name|as_crispy_field }}
		{{ form.storage_space|as_crispy_field }}
		{{ form.start_date|as_crispy_field }}
		{{ form.account_number|as_crispy_field }}
	</fieldset>
	<fieldset>
		<legend><u>Sensitive Information</u></legend>
		{{ form.store_ephi|as_crispy_field }}
	</fieldset>
	<input class="btn btn-primary" type="submit" value="Submit" />
	{% if after_project_creation == 'true' %}
		<a
			class="btn btn-secondary"
			href="{% url 'custom-allocation-create' project_obj.pk %}?after_project_creation=true"
			role="button">Back to Resource Selection
		</a>
	{% else %}
		<a
			class="btn btn-secondary"
			href="{% url 'custom-allocation-create' project_obj.pk %}"
			role="button">Back to Resource Selection
		</a>
	{% endif %}
</form>

<script>
	$(document).ready(function () {
		$("#div_id_account_number").hide()
		if ($("#id_storage_space").val() > 15) {
			$("#div_id_account_number").show()
		}

		$("#id_storage_space").change(function (e) {
			if (e.target.value > 15) {
				$("#div_id_account_number").show()
			} else if (!$("#div_id_account_number").is("hidden")) {
				$("#div_id_account_number").hide()
			}
		})

		var radios = $("[type=radio]").parent()
		for (var i = 0; i < radios.length; i++) {
			console.log(radios[i].className = "custom-control custom-radio custom-control-inline")
		}
		var date = new Date();
		var currentYear = date.getFullYear();
		$(".datepicker")
		.datepicker({
			changeMonth: true,
			changeYear: true,
			yearRange: currentYear + ':' + (currentYear + 1),
		})
	})
</script>
{% endblock %}